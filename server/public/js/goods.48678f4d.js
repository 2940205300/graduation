(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["goods"],{f0f0:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticStyle:{margin:"20px",overflow:"auto"}},[a("el-button",{staticStyle:{margin:"0 auto"},attrs:{type:"primary",round:""},on:{click:t.handleAdd}},[t._v("添加")]),a("el-dialog",{attrs:{title:"商品管理",visible:t.dialogFormVisibleForAdd},on:{"update:visible":function(e){t.dialogFormVisibleForAdd=e}}},[a("el-form",{ref:"AddEditform",attrs:{model:t.AddEditform}},[a("el-form-item",{attrs:{label:"图书名称 ","label-width":t.formLabelWidth}},[a("el-input",{attrs:{autocomplete:"off"},model:{value:t.AddEditform.name,callback:function(e){t.$set(t.AddEditform,"name",e)},expression:"AddEditform.name"}})],1),a("el-form-item",{attrs:{label:"图书分类  ","label-width":t.formLabelWidth}},[a("el-select",{staticStyle:{"margin-right":"20px"},on:{change:t.select_value},model:{value:t.select_val,callback:function(e){t.select_val=e},expression:"select_val"}},t._l(t.ClassName,(function(t){return a("el-option",{key:t.c_id,attrs:{value:t.c_name}})})),1)],1),a("el-form-item",{attrs:{label:"售价","label-width":t.formLabelWidth}},[a("el-input",{attrs:{autocomplete:"off"},model:{value:t.AddEditform.price,callback:function(e){t.$set(t.AddEditform,"price",e)},expression:"AddEditform.price"}})],1),a("el-form-item",{attrs:{label:"作者","label-width":t.formLabelWidth}},[a("el-input",{attrs:{autocomplete:"off"},model:{value:t.AddEditform.author,callback:function(e){t.$set(t.AddEditform,"author",e)},expression:"AddEditform.author"}})],1),a("el-form-item",{attrs:{label:"出版社","label-width":t.formLabelWidth}},[a("el-input",{attrs:{autocomplete:"off"},model:{value:t.AddEditform.press,callback:function(e){t.$set(t.AddEditform,"press",e)},expression:"AddEditform.press"}})],1),a("el-form-item",{attrs:{label:"出版时间","label-width":t.formLabelWidth}},[a("el-date-picker",{attrs:{type:"date",placeholder:"选择日期"},model:{value:t.AddEditform.time,callback:function(e){t.$set(t.AddEditform,"time",e)},expression:"AddEditform.time"}})],1),a("el-form-item",{attrs:{label:"字数","label-width":t.formLabelWidth}},[a("el-input",{attrs:{autocomplete:"off"},model:{value:t.AddEditform.fontnum,callback:function(e){t.$set(t.AddEditform,"fontnum",e)},expression:"AddEditform.fontnum"}})],1),a("el-form-item",{attrs:{label:"简介","label-width":t.formLabelWidth}},[a("el-input",{attrs:{type:"textarea",rows:5,autocomplete:"off"},model:{value:t.AddEditform.info,callback:function(e){t.$set(t.AddEditform,"info",e)},expression:"AddEditform.info"}})],1),a("el-form-item",{attrs:{label:"上传图片","label-width":t.formLabelWidth}},[a("el-upload",{attrs:{action:"http://127.0.0.1:3000/api/admin/order","list-type":"picture-card",accept:"image/jpeg,image/jpg,image/png",limit:1,"auto-upload":!1,"on-change":t.handleChange,"before-upload":t.beforeUpload}},[a("i",{staticClass:"el-icon-plus"})]),a("el-dialog",{attrs:{visible:t.dialogVisible},on:{"update:visible":function(e){t.dialogVisible=e}}},[a("img",{attrs:{width:"100%",src:t.AddEditform.imageUrl,alt:""}})])],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.dialogFormVisibleForAdd=!1}}},[t._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.AddOk("AddEditform")}}},[t._v("确 定")])],1)],1),a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.tableData}},[a("el-table-column",{attrs:{label:"缩略图",width:"200"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",{staticStyle:{"margin-left":"10px",display:"block"}},[a("viewer",{attrs:{images:t.srcList}},[a("img",{directives:[{name:"lazy",rawName:"v-lazy",value:"http://127.0.0.1:3000/assets/uploads/images/"+e.row.g_img,expression:"\n\t\t\t\t\t\t\t\t`http://127.0.0.1:3000/assets/uploads/images/${scope.row.g_img}`\n\t\t\t\t\t\t\t"}],staticStyle:{width:"90px",height:"110px"},attrs:{alt:""},on:{click:t.show}})])],1)]}}])}),a("el-table-column",{attrs:{label:"图书名称",width:"240"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",{staticStyle:{"margin-left":"10px"}},[t._v(t._s(e.row.g_name))])]}}])}),a("el-table-column",{attrs:{label:"作者",width:"230"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",{staticStyle:{"margin-left":"10px"}},[t._v(t._s(e.row.g_author))])]}}])}),a("el-table-column",{attrs:{label:"价格",width:"230"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",{staticStyle:{"margin-left":"10px"}},[t._v(t._s(e.row.g_price))])]}}])}),a("el-table-column",{attrs:{label:"出版社",width:"230"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",{staticStyle:{"margin-left":"10px"}},[t._v(t._s(e.row.g_press))])]}}])}),a("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{size:"mini"},on:{click:function(a){return t.handleEdit(e.$index,e.row)}}},[t._v("编辑")]),a("el-button",{staticStyle:{"margin-left":"20px"},attrs:{slot:"reference",size:"mini",type:"danger"},on:{click:function(a){return t.handleDelete(e.row.g_id,e.row.g_img)}},slot:"reference"},[t._v("删除")])]}}])})],1),a("el-dialog",{attrs:{title:"商品管理",visible:t.dialogFormVisibleForEdit},on:{"update:visible":function(e){t.dialogFormVisibleForEdit=e}}},[a("el-form",{attrs:{model:t.handleEditform}},[a("el-form-item",{attrs:{label:"图书名称 ","label-width":t.formLabelWidth}},[a("el-input",{attrs:{autocomplete:"off"},model:{value:t.handleEditform.name,callback:function(e){t.$set(t.handleEditform,"name",e)},expression:"handleEditform.name"}})],1),a("el-form-item",{attrs:{label:"图书分类  ","label-width":t.formLabelWidth}},[a("el-select",{staticStyle:{"margin-right":"20px"},on:{change:t.select_value},model:{value:t.handleEditform.category,callback:function(e){t.$set(t.handleEditform,"category",e)},expression:"handleEditform.category"}},t._l(t.ClassName,(function(t){return a("el-option",{key:t.c_id,attrs:{value:t.c_name}})})),1)],1),a("el-form-item",{attrs:{label:"售价","label-width":t.formLabelWidth}},[a("el-input",{attrs:{autocomplete:"off"},model:{value:t.handleEditform.price,callback:function(e){t.$set(t.handleEditform,"price",e)},expression:"handleEditform.price"}})],1),a("el-form-item",{attrs:{label:"作者","label-width":t.formLabelWidth}},[a("el-input",{attrs:{autocomplete:"off"},model:{value:t.handleEditform.author,callback:function(e){t.$set(t.handleEditform,"author",e)},expression:"handleEditform.author"}})],1),a("el-form-item",{attrs:{label:"出版社","label-width":t.formLabelWidth}},[a("el-input",{attrs:{autocomplete:"off"},model:{value:t.handleEditform.press,callback:function(e){t.$set(t.handleEditform,"press",e)},expression:"handleEditform.press"}})],1),a("el-form-item",{attrs:{label:"出版时间","label-width":t.formLabelWidth}},[a("el-date-picker",{attrs:{type:"date",placeholder:"选择日期"},model:{value:t.handleEditform.time,callback:function(e){t.$set(t.handleEditform,"time",e)},expression:"handleEditform.time"}})],1),a("el-form-item",{attrs:{label:"字数","label-width":t.formLabelWidth}},[a("el-input",{attrs:{autocomplete:"off"},model:{value:t.handleEditform.fontnum+"万字",callback:function(e){t.$set(t.handleEditform,"fontnum + '万字'",e)},expression:"handleEditform.fontnum + '万字'"}})],1),a("el-form-item",{attrs:{label:"简介","label-width":t.formLabelWidth}},[a("el-input",{attrs:{type:"textarea",rows:5,autocomplete:"off"},model:{value:t.handleEditform.info,callback:function(e){t.$set(t.handleEditform,"info",e)},expression:"handleEditform.info"}})],1),a("el-form-item",{attrs:{label:"图片","label-width":t.formLabelWidth}},[a("el-upload",{attrs:{action:"http://127.0.0.1:3000/api/admin/order","list-type":"picture-card",accept:"image/jpeg,image/jpg,image/png",limit:1,"auto-upload":!1,"on-change":t.handleChange,"before-upload":t.beforeUpload}},[a("i",{staticClass:"el-icon-plus"})]),a("el-dialog",[a("img",{attrs:{width:"100%",src:t.handleEditform.imageUrl,alt:""}})])],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.dialogFormVisibleForEdit=!1}}},[t._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:t.EditOk}},[t._v("确 定")])],1)],1)],1)},l=[],o=(a("b0c0"),a("4de4"),a("bc3a")),d=a.n(o),r={name:"",inject:["reload"],components:{},data:function(){return{tableData:[],fits:"fill",srcList:[],dialogFormVisibleForAdd:!1,dialogFormVisibleForEdit:!1,formLabelWidth:"100px",ClassName:[],AddEditform:{name:"",category:"",price:"",author:"",press:"",time:"",fontnum:"",info:"",imageUrl:"",file:""},handleEditform:{id:"",name:"",category:"",price:"",author:"",press:"",time:"",fontnum:"",info:"",imageUrl:"",file:""},dialogVisible:!1,arr:[],formData:{},select_val:""}},computed:{},created:function(){var t=this;d.a.get("/api/admin/category").then((function(e){t.ClassName=e.data.data})),d.a.get("/api/admin/goods").then((function(e){t.tableData=e.data.data,a=e.data;for(var a=[],i=0;i<t.tableData.length;i++)a.push("http://127.0.0.1:3000/assets/uploads/images/"+t.tableData[i].g_img);t.srcList=a}))},mounted:function(){},getDrawerTableList:function(t){},methods:{handleAdd:function(){this.dialogFormVisibleForAdd=!0},show:function(){this.$viewerApi({images:this.srcList})},OnProgress:function(t){},handleDelete:function(t,e){var a=this;this.$confirm("删除后不能恢复，确定要删除吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){console.log("发送删除请求"),d.a.delete("/api/admin/deletegoods",{params:{id:t,img:e}}).then((function(t){a.reload(),a.$message({type:"success",message:"删除成功!"})}))})).catch((function(){a.$message({type:"warning",message:"已取消删除"})}))},handleEdit:function(t,e){this.dialogFormVisibleForEdit=!0,this.handleEditform.id=e.g_id,this.handleEditform.name=e.g_name,this.handleEditform.category=e.c_name,this.handleEditform.price=e.g_price,this.handleEditform.author=e.g_author,this.handleEditform.press=e.g_press,this.handleEditform.time=e.g_time,this.handleEditform.fontnum=e.g_fontnum,this.handleEditform.info=e.g_info,this.handleEditform.imageUrl=e.g_img},EditOk:function(){var t=this,e=new FormData;e.append("g_id",this.handleEditform.id),e.append("imgfile",this.file),e.append("g_name",this.handleEditform.name),e.append("c_id",this.AddEditform.category),e.append("g_price",this.handleEditform.price),e.append("g_author",this.handleEditform.author),e.append("g_press",this.handleEditform.press),e.append("g_img",this.handleEditform.imageUrl),e.append("g_time",this.moment(this.handleEditform.time).format("YYYY-MM-DD")),e.append("g_fontnum",this.handleEditform.fontnum),e.append("g_info",this.handleEditform.info),d.a.post("/api/admin/updategoods",e,{headers:{"Content-Type":"multipart/form-data"}}).then((function(e){t.dialogFormVisibleForEdit=!1,t.reload()}))},handleChange:function(t,e){this.file=t.raw},beforeUpload:function(t){var e=t.size/1024/1024<2;return e||this.$message.error("上传图片大小不能超过 2MB!"),e},select_value:function(t){var e=this.ClassName.filter((function(e){return e.c_name==t}));this.AddEditform.category=e[0].c_id,this.select_val=e[0].c_name},AddOk:function(){var t=this,e=new FormData;e.append("imgfile",this.file),e.append("g_name",this.AddEditform.name),e.append("c_id",this.AddEditform.category),e.append("g_price",this.AddEditform.price),e.append("g_author",this.AddEditform.author),e.append("g_press",this.AddEditform.press),e.append("g_time",this.moment(this.AddEditform.time).format("YYYY-MM-DD")),e.append("g_fontnum",this.AddEditform.fontnum),e.append("g_info",this.AddEditform.info),d.a.post("/api/admin/addgoods",e,{headers:{"Content-Type":"multipart/form-data"}}).then((function(e){t.dialogFormVisibleForAdd=!1,t.reload()}))}}},n=r,s=a("2877"),m=Object(s["a"])(n,i,l,!1,null,"7f0d4a2a",null);e["default"]=m.exports}}]);
//# sourceMappingURL=goods.48678f4d.js.map